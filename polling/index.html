



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.6.3">
    
    
      
        <title>Understanding Input Data Collection - pymata-express</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application.adb8469c.css">
      
      
    
    
      <script src="../assets/javascripts/modernizr.86422ebf.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../assets/fonts/material-icons.css">
    
    
    
      
    
    
  </head>
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#processing-input-data" tabindex="0" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href=".." title="pymata-express" aria-label="pymata-express" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              pymata-express
            </span>
            <span class="md-header-nav__topic">
              
                Understanding Input Data Collection
              
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" aria-label="search" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main" role="main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href=".." title="pymata-express" class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </a>
    pymata-express
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="What Is pymata-express?" class="md-nav__link">
      What Is pymata-express?
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2" checked>
    
    <label class="md-nav__link" for="nav-2">
      The pymata-express API
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        The pymata-express API
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Understanding Input Data Collection
      </label>
    
    <a href="./" title="Understanding Input Data Collection" class="md-nav__link md-nav__link--active">
      Understanding Input Data Collection
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#firmata-data-collection" class="md-nav__link">
    Firmata Data Collection
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#firmata-data-polling" class="md-nav__link">
    Firmata Data Polling
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#digital-input" class="md-nav__link">
    Digital Input
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#analog-input" class="md-nav__link">
    Analog Input
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#i2c-input" class="md-nav__link">
    I2C Input
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sonar-hc-sr04-input" class="md-nav__link">
    Sonar (HC-SR04) Input
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#using-pymata-express-to-access-input-data" class="md-nav__link">
    Using Pymata-Express To Access Input Data
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#polling-for-input-data-changes" class="md-nav__link">
    Polling For Input Data Changes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-callbacks-instead-of-polling" class="md-nav__link">
    Using Callbacks Instead Of Polling
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../init/" title="The __init__ Method" class="md-nav__link">
      The __init__ Method
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../pin_modes/" title="Setting Pin Modes" class="md-nav__link">
      Setting Pin Modes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../enable_disable/" title="Enabling/Disabling Analog And Digital Reporting" class="md-nav__link">
      Enabling/Disabling Analog And Digital Reporting
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../pin_changes/" title="Reading Input Data Via Polling" class="md-nav__link">
      Reading Input Data Via Polling
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../device_writes/" title="Writing Values To Pins And Selected Devices" class="md-nav__link">
      Writing Values To Pins And Selected Devices
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../i2c/" title="I2C Reads And Writes" class="md-nav__link">
      I2C Reads And Writes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../report_requests/" title="Report Requests" class="md-nav__link">
      Report Requests
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../management/" title="Management Requests" class="md-nav__link">
      Management Requests
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../exceptions/" title="Exceptions" class="md-nav__link">
      Exceptions
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../concurrency/" title="The pymata-express Concurrency Model" class="md-nav__link">
      The pymata-express Concurrency Model
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      System and Installation Requirements
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        System and Installation Requirements
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../python_3_7_install/" title="Verifying Python 3 Version" class="md-nav__link">
      Verifying Python 3 Version
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../python_install/" title="Python 3 Installation" class="md-nav__link">
      Python 3 Installation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../install_pymata_express/" title="Installing pymata-express" class="md-nav__link">
      Installing pymata-express
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../firmata_express/" title="Installing FirmataExpress" class="md-nav__link">
      Installing FirmataExpress
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../about/" title="About" class="md-nav__link">
      About
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../license/" title="License" class="md-nav__link">
      License
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#firmata-data-collection" class="md-nav__link">
    Firmata Data Collection
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#firmata-data-polling" class="md-nav__link">
    Firmata Data Polling
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#digital-input" class="md-nav__link">
    Digital Input
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#analog-input" class="md-nav__link">
    Analog Input
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#i2c-input" class="md-nav__link">
    I2C Input
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sonar-hc-sr04-input" class="md-nav__link">
    Sonar (HC-SR04) Input
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#using-pymata-express-to-access-input-data" class="md-nav__link">
    Using Pymata-Express To Access Input Data
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#polling-for-input-data-changes" class="md-nav__link">
    Polling For Input Data Changes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-callbacks-instead-of-polling" class="md-nav__link">
    Using Callbacks Instead Of Polling
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="processing-input-data">Processing Input Data</h1>
<p>Before discussing the API, understanding how both Firmata generates input data 
notification messages, as well as 
how pymata-express processes these messages, may be
beneficial in designing your application. Understanding the
differences between using a callback versus polling is 
crucial when designing your application.</p>
<h2 id="firmata-data-collection">Firmata Data Collection</h2>
<p>Both the FirmataExpress and StandardFirmata sketches poll all input pins within the <em>loop method</em>
of the sketch.</p>
<p>Firmata builds notification messages containing the pin number, pin type, and data value,
 and transmits these messages to pymata-express
over the serial link.</p>
<h2 id="firmata-data-polling">Firmata Data Polling</h2>
<h3 id="digital-input">Digital Input</h3>
<p>For digital input pins, all the pins are polled with <em>each</em> iteration of the sketch <em>loop</em>,
with no delays. If the state of a pin has changed since the last loop iteration,
Firmata creates a notification message and transmits the message over the serial link
to pymata-express.</p>
<h3 id="analog-input">Analog Input</h3>
<p>For analog input pins, each pin is polled, and its current value is reported,
regardless of change. 
All analog input pins are nominally polled every 19 milliseconds.</p>
<h3 id="i2c-input">I2C Input</h3>
<p>Unlike digital and analog inputs, most I2C devices report values only when a read request is issued 
 to the i2c device. For these i2c devices, a read request results in a single reply. </p>
<p>Some i2c devices may be placed in a continuous read mode. In this
mode, the i2c device automatically sends update notifications,
 usually as quickly as possible. When in continuous i2c mode, 
the Firmata <em>loop</em> retrieves cached responses at a nominal polling rate of 19 milliseconds.</p>
<h3 id="sonar-hc-sr04-input">Sonar (HC-SR04) Input</h3>
<p>FirmataExpress supports HC-SR04 type distance sensors. The Firmata <em>loop</em> polls each device 
and reports its current value regardless of change.
The polling rate is nominally every 40 milliseconds for HC-SR04 type devices.</p>
<h2 id="using-pymata-express-to-access-input-data">Using Pymata-Express To Access Input Data</h2>
<h3 id="polling-for-input-data-changes"><em>Polling</em> For Input Data Changes</h3>
<p>As pymata-express receives input data notifications, 
it caches the data in internal data structures. These data structures retain
the value reported as well as the time of occurrence.
The application may query or poll these data structures to obtain the
latest data updates for a given pin. </p>
<p>The pymata-express API methods that implement polling are:</p>
<ul>
<li>analog_read</li>
<li>digital_read</li>
<li>i2c_read_saved_data</li>
<li>sonar_read</li>
</ul>
<p>A more efficient and automatic way for your application to be notified
of data updates is to use the pymata-express <em>callback</em> feature. </p>
<h3 id="using-callbacks-instead-of-polling">Using <em>Callbacks</em> Instead Of Polling</h3>
<p>Callback notification is much more efficient than using polling.</p>
<p>A callback is simply a function or method written by you, that is called automatically
by pymata-express when it receives an input data notification message from Firmata.</p>
<p>You may optionally <em>register</em> callback functions when using any of the following pymata-express API
methods:</p>
<ul>
<li>set_pin_mode_analog_input</li>
<li>set_pin_mode_digital_input</li>
<li>set_pin_mode_digital_input_pullup</li>
<li>set_pin_mode_sonar</li>
<li>enable_analog_reporting (an alias for set_pin_mode_analog_input)</li>
<li>i2c_read</li>
<li>i2c_read_continuous</li>
<li>i2c_read_restart_transmission</li>
</ul>
<p>You may write a callback function for each input pin, write
a callback function to handle any pin of single type, such as analog input
or digital input, or even have a single callback function handle all input data notifications.</p>
<p>You may use callbacks with some pins while using polling for others. Polling is available
for all input pins whether callbacks are in use or not.</p>
<p>A callback function is specified to accept a single input parameter, typically named
<strong><em>data</em></strong>. The input parameter will be filled with a list when pymata-express invokes the callback.
A description of what is contained in the list
is provided in the 
<a href="https://htmlpreview.github.com/?https://github.com/MrYsLab/pymata-express/blob/master/html/pymata_express/index.html">reference API.</a></p>
<pre><code class="python">def my_callback(data):
    &quot;&quot;&quot;
    :param data: a list containing pin type, pin number, 
                 data value and time-stamp
    &quot;&quot;&quot;
# Your code goes here to process the data
</code></pre>

<p><strong>TIP</strong>: You should keep callback functions as short as possible. If processing callback
data within the callback function results in blocking your application, 
you may wish to consider spawning a separate
processing thread.</p>
<p><br>
<br></p>
<p>Copyright (C) 2020 Alan Yorinks. All Rights Reserved.</p>
                
                  
                
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href=".." title="What Is pymata-express?" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                What Is pymata-express?
              </span>
            </div>
          </a>
        
        
          <a href="../init/" title="The __init__ Method" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                The __init__ Method
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org" target="_blank" rel="noopener">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs</a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application.c33a9706.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:".."}})</script>
      
    
  </body>
</html>